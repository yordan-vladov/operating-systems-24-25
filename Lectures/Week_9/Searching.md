# Търсене на файлове

---
## Съдържание

- Търсене на файлове по име
- Търсене във файловата йерархия
- Работа с намерени
---
## locate

- Позволява ни да търсим файлове по име
```bash
locate bin/zip
locate zip | grep bin
```
---
## find

- Позволява ни да търсим съдържанието на дадена папка
```bash
find ~ # намира всички в нашата home директория
```
---
## find -type

- Връща само ресурси от определен тип
```bash
find ~ -type d # връща само директории
find ~ -type f # връща само файлове
```
---

| Тип | Описание           |
| --- | ------------------ |
| b   | Блоково устройство |
| c   | Символен файл      |
| d   | Директория         |

---

| Тип | Описание       |
| --- | -------------- |
| f   | Обикновен файл |
| l   | Символен линк  |

---
## find -name

- Позволява ни да търсим файлове, чийто имена спазват определен шаблон
```bash
find ~ -type f -name "*.txt"
```
---
## find -size

```bash
find ~ -type f -size +1M # повече от 1 MB
find ~ -type f -size -1k # по-малко от 1 kB
```

---

| Символ | Единица         |
| ------ | --------------- |
| b      | 512-байтов блок |
| c      | байтов          |
| w      | 2-байтова дума  |

---

| Символ | Единица  |
| ------ | -------- |
| k      | килобайт |
| М      | мегабайт |
| G      | гигабайт |

---
## find -cmin n

- Намира файловете, чието съдържание е модифициране преди точно *n* минути (+n за повече от n, -n за по-малко от n)
```bash
find ~ -cmin 5 # модифицирани преди точно 5 минути
find ~ -cmin +5 # модифицирани преди повече от 5 минути
find ~ -cmin -5 # модифицирани преди по-малко от 5 минути
```

---
## find -cnewer file

- Намира файловете, чието съдържание е модифициране по-скоро от съдържанието на *file*
```bash
find ~ -cnewer test.txt # модифицирани по-скор от test.txt
```

---
## find -empty

- Намира празни файлове и директории
```bash
find ~ -empty
```

---
## find -nouser

- Намира файлове и директории, принадлежащи на невалиден потребител
```bash
find / -nouser
```

---
## find -perm mode

- Намира всичките файлове и директории, притежаващи конкретни привилегии
```bash
find ~ -perm 755
```

---
## Други филтри

- За други полезни филтри, вижте **man** страницата на **find**
```bash
man find
```

---
## Оператори

- Позволяват ни да комбинираме няколко условия при търсенето:
    - **-and**: Връщаме ресурси, които спазват всички зададени условия
    - **-or**: Връщаме ресурси, които спазват поне едно от зададените условия
---
- **-not**: Връщаме ресурси, които не спазват зададеното условие
- **()**: Позволяват ни да групираме условия
---
```bash
find ~ -mtime -7 -and -user john # всички ресурси на john, които са променяни в последните 7 дена
find ~ -name "*.txt" -or -name "*.log" # всички .txt и .log файлове
find ~ -not -user john # всички файлове, които не са на john
find ~ \( -name "*.txt" -and -user john \) -or -name "*.log"
# всички .log файлове ИЛИ всички .txt файлове на john
```
---
## Действия

- Позволяват ни да направим нещо с намерените ресурси:
    - **-delete** - трие съответстващите файлове
    - **-ls** - дава детайли за намерените файлове
    - **-print** - принтира файлът/директория (default)
    - **-quit** - спира търсенето, след като е направено съотвествие
---
```bash
find ~ -type f -empty -delete # трие празни файлове
find ~ -type f -name "*.sh" -ls # извежда информация за всички shell скриптове
find ~ -type f -size +100M -print -quit # намира файл по-голям от 100 MB и спира
```


---
## xargs

- Позволява ни подадем намерените файлове/директории като аргумент на команда
---
```bash
find ~ -name "*.txt" | xargs cat # принтира всичките текстови файлове
find ~ -name "*.txt" | xargs wc -l # принтира броят редове всичките текстови файлове
find ~ -name "*.sh" | xargs chmod +x
```
---
## Опции

- Определят обхвата на търсенето
- **-maxdepth levels** - максималната дълбочина на търсенето
- **-mindepth levels** - минималната дълбочина на търсенето
---
```bash
find ~ -maxdepth 2 # търси само в текушата директория и в нейните преки "деца"
find ~ -mindepth 2 # търси само в текушата директория и в нейните преки "деца"
```
