# Операционни системи - Компоненти

---

## Съдържание

- Ядро
- Системни Повиквания
- Потребителски приложения

---

![OS_Structure.png](/Attachments/OS_Structure.png)

---

## Ядро

- частта от компютъра, която се изпълнява по всяко време
- предоставя основни услуги за всички останали части на операционната система
- Ред на стартиране: BIOS => Boot loader => Kernel => User Apps
- Зареден е в защитено пространство на паметта

---

## Ядро - Цел

1. Осигурява интерфейсите, необходими на потребителите и приложенията за взаимодействие с компютъра.
2. Стартира и управлява приложения.
3. Управлява базовите системни хардуерни устройства.

---

- Зареждане и управление на по-малко критични компоненти на ОС, като например драйвери на устройства.
- Организиране и управление на нишки и различни процеси, породени от работещи приложения.
- Планиране кои приложения имат достъп и използване на ядрото и контролиране на това използване, когато настъпи планираният час.

---

- Решаване кое незащитено пространство на потребителската памет използва всеки процес на приложение.
- Справяне с конфликти и грешки в разпределението и управлението на паметта.
- Управление и оптимизиране на хардуерни ресурси и зависимости, като централен процесор (CPU) и използване на кеша, работа на файловата система и механизми за мрежов транспорт.

---

- Управление и достъп до I/O устройства като клавиатури, мишки, дискови устройства, USB портове, мрежови адаптери и дисплеи.
- Обработка на системни повиквания на устройства и приложения с помощта на различни механизми като хардуерни прекъсвания или драйвери на устройства.

---

## Драйвери

- Осъществяват комуникация между ядрото и физически устройства като принтери и графични адаптери
- Без драйверите ядрото само трябва да осъществява комуникация с всяко възможно физическо устройство
- Най-често се добавят автоматично при инсталирането на операционната система

---

## Драйвери - Пример

- HDD срещу SSD
- Устройствата имат напълно различен начин на работа, но вършат еднаква функция

---

![HDD_vs_SSD.png](/Attachments/HDD_vs_SSD.png)

---

## Драйвери - видове 1/2

- За Символни устройства - портове, звукови карти, др.
- За Блокови устройства - хард дискове, usb камери, др.
- За Мрежови устройства - мрежови карти

---

## Драйвери - видове 2/2

- За устройства от ядрото
- За потребителски устройства

---

## ОС - Режим на работа

- Режим на ядрото
- Потребителски режим

---

## Режим на ядрото

- Софтуерът има пълен и неограничен достъп до системата и нейните ресурси
- Използва от ядрото на ОС и неговите основни услуги (драйвери, системни повиквания, т.н)

---

## Потребителски режим

- Използва се от всички останали приложения
- Ресурсите се приготвят от ядрото
- Достъпват системните ресурси чрез повиквания

---

## Превключване на режими

- Процесорът превключва в режим на ядрото, докато ядрото обработва своите системни извиквания и след това превключва обратно в потребителски режим, за да продължи да работи с приложенията.

---

## Видове ядра

- Определят се спрямо мащаба на ядрото
- Има два основни вида:
    - Монолитно ядро
    - Микроядро

---

### Монолитно ядро

- По-старият подход
- Изпълнява всяка основна системна услуга
- Примери: Unix MS-DOS, ранните MacOS

---

![Linux_Kernel_Map.png](/Attachments/Linux_Kernel_Maps.png)

---
### Монолитно ядро - Недостатъци

1. размер на ядрото
2. липса на разширяемост
3. лоша поддръжка

---

## Микроядро

- ядрото се намалява до контрол на процеси и I/O
- другите функционалности пребивават в потребителското пространство като нормални процеси наречени сървъри
- нужно е "контекстно превключване", за да могат потребителските процеси да влязат в привилегирован режим

---

## Системни повиквания

- Осигуряват интерфейс към услугите предоставени от операционната система.
- Могат да бъдат написани на C, C++, Assembly и др.
- Ще видим какви повиквания се правят при изпълняване на проста програма

---

![Example_System_Calls.png](/Attachments/Example_System_Calls.png)

---
## API

- **Application Programming Interface**
- Дефинира функциите, до които програмиста има достъп
- Опростява повикваният, които трябва да се правят

---
## Популярни API-та

- Windows API - за Windows системи
- POSIX API - за Linux, MacOS и др.
- Java API - За програми, които се стартират на JVM
- API се достъпва чрез библиотека от код

---

## API - Предимства

- Често функция от API-то просто извиква съответното системно повикване (напр. `CreateProcess` извиква `NTCreateProcess` при Windows системи)
- Това предоставя по-голяма преносимост на кода
- Пример: Linux и MacOS имат различни системни повиквания, но предоставят едно и също API

---

## System-call-interface

- Връзка между API и системните повиквания
- Засича извиквани API функции и извиква нужни системни повиквания
- Потребителите трябва само да знаят API функциите, вместо системните функции

---

![System_Call_Interface.png](/Attachments/System_Call_Interface.png)

---

## Системни повиквания - параметри

- Могат да се в:
    - регистрите
    - блок от паметта
    - в програмният стек

---

![Example_Parameters.png](/Attachments/Example_Parameters.png)

---

## Типове Системни Повиквания

- 6 Основни вида: Контрол на процесите, Управление на файловете, Управление на устройства, Поддръжка на информация, Комуникация, Защита

---

## Управление на процеси

- Приключване (`end()`) или Прекъсване на процесите (`abort()`)
- Зареждане (`load()`) и изпълнение (`execute()`) на програми
- Създаване (`create_process()`) и спиране (`terminate_process()`) на процеси

---

- Определяне на качествата на процес (`get_process_attributes()`, `set_process_attributes()`)
- Изчакване време да мине (`wait_time()`) или явление на да се изпълни (`wait_event()`)
- Сигнализиране, че явление се изпълнило (`signal_event()`)

---

- Заделяне и освобождаване на данни
- Заключване и отключване на данни

---

## Управление на файлове

- Създаване (`create()`) и Триене (`delete()`)
- Отваряне (`open()`) и затваряне(`close()`)
- Четене (`read()`), Писане (`write()`)

---

- Навигиране (`reposition()`) на файлове
	 - Връщаме се в началото или отиваме в края на файл
- Определяне на качествата (`get_file_attributes()`, `set_file_attributes()`)
- Преместване (`move()`) и копиране (`copy()`)

---

## Управление на устройства

- Искане (`request()`), Освобождаване (`release()`)
- Четене (`read()`), Писане (`write()`), Навигиране (`reposition()`)
- Определяне на качествата (`get_device_attributes()`, `set_device_attributes()`)
---

## Поддържане на информация

- Текущо време (`time()`) и дата (`date()`)
- Управление на информация за процеси, файлове или устройства
- Достъп до информация за дадена програма (`dump()`)

---

## Комуникация

- Създаване и триене на връзки
- Изпращане и получаване на съобщения
- Споделяне на памет

---

## Защита

- Управляване на достъп до ресурси
- Променяне или получаване на привилегиите на даден ресурс
- Даване или Отказване достъп на даден потребител

---

## Потребителски интерфейс

- Позволява на потребителя да взаимодейства с компютъра
- Може да бъде команден и графичен

---

## Команден интерфейс

- Потребителят въвежда команди, които компютърът да изпълнява
- Много ОС предлагат множество командни интерпретатори, наречени **шелове** (**shell** - обвивка)
- Примери: bash, zsh, fish, ...

---

![Example_Terminal.png](/Attachments/Example_Terminal.png)

---

## Графичен интерфейс

- Потребителят навигира чрез мишка или жестове различни прозорци и менюта
- Файлове, програми и папки за представени чрез икони
- Примери: Gnome, KDE, Windows UI

---

![Example_DE.png](/Attachments/Example_DE.png)

---

## Интерфейси - Разлики

- Графичните интерфейси са по-лесни за използване
- Командните интерфейси са по-мощни

---
